

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/avatar.png">
  <link rel="icon" href="/img/avatar.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="Qi Xu">
  <meta name="keywords" content="">
  <meta name="description" content="Using docker and jenkins to deploy a websiteWhy choose this topic?By using jenkins, we can deploy and update the website automatilcally. Also, we need to use ssh keys to proceed a series of operations">
<meta property="og:type" content="article">
<meta property="og:title" content="Using docker and jenkins to deploy a website">
<meta property="og:url" content="http://example.com/2021/06/04/My-New-Post/index.html">
<meta property="og:site_name" content="Qi&#39;s World">
<meta property="og:description" content="Using docker and jenkins to deploy a websiteWhy choose this topic?By using jenkins, we can deploy and update the website automatilcally. Also, we need to use ssh keys to proceed a series of operations">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/images/post1/1.png">
<meta property="og:image" content="http://example.com/images/post1/3.png">
<meta property="og:image" content="http://example.com/images/post1/4.png">
<meta property="og:image" content="http://example.com/images/post1/5.png">
<meta property="og:image" content="http://example.com/images/post1/2.png">
<meta property="og:image" content="http://example.com/images/post1/6.png">
<meta property="og:image" content="http://example.com/images/post1/7.png">
<meta property="og:image" content="http://example.com/images/post1/8.png">
<meta property="og:image" content="http://example.com/images/post1/9.png">
<meta property="og:image" content="http://example.com/images/post1/10.png">
<meta property="og:image" content="http://example.com/images/post1/11.png">
<meta property="og:image" content="http://example.com/2021/06/04/My-New-Post/images/12.png">
<meta property="og:image" content="http://example.com/images/post1/13.png">
<meta property="og:image" content="http://example.com/images/post1/14.png">
<meta property="og:image" content="http://example.com/images/post1/15.png">
<meta property="og:image" content="http://example.com/2021/06/04/My-New-Post/images/18.png">
<meta property="og:image" content="http://example.com/images/post1/16.png">
<meta property="og:image" content="http://example.com/images/post1/17.png">
<meta property="og:image" content="http://example.com/images/post1/27.png">
<meta property="og:image" content="http://example.com/images/post1/26.png">
<meta property="og:image" content="http://example.com/images/post1/25.png">
<meta property="og:image" content="http://example.com/images/post1/19.png">
<meta property="og:image" content="http://example.com/images/post1/20.png">
<meta property="og:image" content="http://example.com/images/post1/21.png">
<meta property="og:image" content="http://example.com/images/post1/22.png">
<meta property="og:image" content="http://example.com/images/post1/23.png">
<meta property="og:image" content="http://example.com/images/post1/24.png">
<meta property="article:published_time" content="2021-06-04T18:32:43.000Z">
<meta property="article:modified_time" content="2022-02-18T09:13:21.821Z">
<meta property="article:author" content="Qi Xu">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/images/post1/1.png">
  
  <title>Using docker and jenkins to deploy a website - Qi&#39;s World</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->

  
<link rel="stylesheet" href="/css/project.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.12","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname"}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.1"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Qi&#39;s World</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/projects/">
                <i class="iconfont icon-exp-fill"></i>
                Projects
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="Using docker and jenkins to deploy a website">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-06-04 11:32" pubdate>
        Friday, June 4, 2021 11:32 AM
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      7.1k words
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      9 mins
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Using docker and jenkins to deploy a website</h1>
            
              <p class="note note-info">
                
                  Last updated on：Friday, February 18, 2022 1:13 AM
                
              </p>
            
            <div class="markdown-body">
              <h1 id="Using-docker-and-jenkins-to-deploy-a-website"><a href="#Using-docker-and-jenkins-to-deploy-a-website" class="headerlink" title="Using docker and jenkins to deploy a website"></a>Using docker and jenkins to deploy a website</h1><h4 id="Why-choose-this-topic"><a href="#Why-choose-this-topic" class="headerlink" title="Why choose this topic?"></a>Why choose this topic?</h4><p>By using jenkins, we can deploy and update the website automatilcally. Also, we need to use ssh keys to proceed a series of operations. With jenkins, we can also package our proejct automatically.</p>
<blockquote>
<p>Tools we need:</p>
<p>Docker — To run the Jenkins</p>
<p>Jenkins — Auto deploy platform</p>
<p>Nginx — website server</p>
</blockquote>
<h3 id="Let’s-Start"><a href="#Let’s-Start" class="headerlink" title="Let’s Start!"></a><strong>Let’s Start!</strong></h3><h4 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h4><p>You should install docker on your environment. If you did not install, please follow with the link <code>https://www.docker.com/get-started</code></p>
<p>I am using desktop version for mac, so I can make sure the docker is running by check the icon.</p>
<img src="/images/post1/1.png" srcset="/img/loading.gif" lazyload alt="1" style="zoom:50%;" />

<h4 id="Jenkins"><a href="#Jenkins" class="headerlink" title="Jenkins"></a>Jenkins</h4><p>Open your terminal, using docker command pull and run the jenkins.</p>
<p><code>docker run -p 8080:8080 -p 50000:50000 -d -v jenkins_home:/jenkins_home jenkins/jenkins:lts-jdk11</code></p>
<p><strong>Note: the version should be the latest, it is important because you will fail to install some plugins if the images is not the latest. To find the latest, follow the link <code>https://hub.docker.com/r/jenkins/jenkins</code>, the official jenkins stops update, so choose the /jenkins/jenkins</strong></p>
<ul>
<li>-p: map a local port 8080 to the docker port 8080</li>
<li>-d: run in the background</li>
<li>-v create a volume for jenkins, so we can store the configurations in the file.</li>
<li>Make sure we use jenkins/jenkins:lts, it is the latest version.</li>
</ul>
<p>When the jenkins is downloaded and running, we cannot see anything from the terminal.</p>
<p>But we can open our browser and enter <code>localhost:8080</code> to open the jenkins.</p>
<p><img src="/images/post1/3.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 4.06.23 PM"></p>
<p>It says we need a password to unlock the jenkins. By looking at the password, we need to know which container it is by the command <code>docker ps</code></p>
<p><img src="/images/post1/4.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 4.07.53 PM"></p>
<p>Copy the container id and use the command <code>docker logs + [container id]</code> to inspect the logs of the container when we run it. <em>If we delete -d mode when we run it, the log will be automatically displayed</em></p>
<p><img src="/images/post1/5.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 4.10.11 PM"></p>
<p>We can find the password similar like this, then put it into the website. We can got this. Because we need to make sure we have basic plugins, just choose the first option.</p>
<p><img src="/images/post1/2.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/images/post1/6.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 4.11.01 PM"></p>
<p>After we finish installation, we need to create a admin user.</p>
<p><img src="/images/post1/7.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 5.03.59 PM"></p>
<p>Click finish</p>
<p><img src="/images/post1/8.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 5.04.57 PM"></p>
<p>This is our jenkins! But before we use it, we need to install some plugins. </p>
<h5 id="Publish-over-ssh"><a href="#Publish-over-ssh" class="headerlink" title="Publish over ssh"></a><strong>Publish over ssh</strong></h5><p>Click <code>Manage Jenkins</code> -&gt; <code>Manage Plugins</code> -&gt; search <code>publish over ssh</code></p>
<p><img src="/images/post1/9.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 5.05.17 PM"></p>
<p>Choose install without restart because we do not need to restart to use this service.</p>
<p><img src="/images/post1/10.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 5.15.31 PM"></p>
<p>Now we have to configure our ssh connection before we move on.</p>
<p>Click <code>Manage Jenkins</code>-&gt; <code>Configure system</code>-&gt; Scroll down to the bottom when you can see Publish over ssh</p>
<p>There are some steps you need to follow to get connecting.</p>
<p><img src="/images/post1/11.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 6.54.05 PM"></p>
<ol>
<li><p>Open up your terminal, enter <code> ssh-keygen -t rsa -b 1024</code> to generate ssh key. Note that you may provide a passphrase.</p>
<img src="images/12.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 7.00.49 PM" style="zoom:80%;" /></li>
<li><p>Use <code>Cat .ssh/id_rsa</code> and copy the keys.</p>
</li>
<li><p>Enter in you passphrase when you generate the keys and Paste the copied keys into the “Key” section in the form.</p>
</li>
<li><p>Click <code>Add Server</code> and input the server information, here, I take my localhost as the server. If you have any cloud server, you can put those information here. You should click “User password auth…” if you have a password in your server.</p>
<p><img src="/images/post1/13.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 7.04.19 PM"></p>
</li>
<li><p>Click Test connection and you will see “success”. If you did not see it, you might start your remote ssh login service. Usually it is sshd, but I am using mac, so I just open “settings-&gt;share-&gt;remote login” to enable it.</p>
</li>
</ol>
<p><strong>Node</strong></p>
<p>Because we are planning to deploy a website, the node plugin will help us to run the website. Similar when we install publish over ssh.</p>
<p>After installed the NodeJs, we should configure it(make sure which version we will use)</p>
<p>Click <code>Manage Jenkins</code>-&gt;<code>Global Tool Configuration</code> and find the NodeJs, <code>add NodeJs</code></p>
<p>Specify the name and choose the node version, then click save to finish configuration.</p>
<p><img src="/images/post1/14.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 7.15.53 PM"></p>
<p><strong>Prepare a website project</strong></p>
<p>Here, I am using VUE to create a project called cs312final by the command <code>vue create cs312final</code></p>
<p>Similar to the React, vue use components to build website.</p>
<p>By default, when I run <code>npm run serve</code> it will port a page like this.</p>
<p><img src="/images/post1/15.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 10.17.08 PM"></p>
<p>There are two files that we are going to create. Because we are going to use nginx as a server to render our website in a docker. We need to create files of <code>Dockerfile</code> and <code>nginx.conf</code></p>
<p>For <code>Dockerfile</code> we only want to run a nginx, so we will have:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> nginx<br><span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">80</span><br><span class="hljs-keyword">COPY</span><span class="language-bash"> dist /usr/share/nginx/html</span><br><span class="hljs-keyword">COPY</span><span class="language-bash"> nginx.conf /etc/nginx/nginx.con</span><br></code></pre></td></tr></table></figure>

<p>Expose a port 80 from the container.</p>
<p>For nginx.conf, we just simply configure it. The detailes are in comment.</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">user</span>  nginx;<br><span class="hljs-comment"># working process number</span><br><span class="hljs-attribute">worker_processes</span>  <span class="hljs-number">1</span>;<br><br><span class="hljs-attribute">error_log</span>  /var/log/nginx/<span class="hljs-literal">error</span>.log <span class="hljs-literal">warn</span>;<br><span class="hljs-attribute">pid</span>        /var/run/nginx.pid;<br><br><br><span class="hljs-section">events</span> &#123;<br>    <span class="hljs-comment"># number of connection</span><br>    <span class="hljs-attribute">worker_connections</span>  <span class="hljs-number">1024</span>;<br>&#125;<br><br><br><span class="hljs-section">http</span> &#123;<br>    <span class="hljs-attribute">include</span>       /etc/nginx/mime.types;<br>    <span class="hljs-attribute">default_type</span>  application/octet-stream;<br><br>    <span class="hljs-attribute">log_format</span>  main  <span class="hljs-string">&#x27;<span class="hljs-variable">$remote_addr</span> - <span class="hljs-variable">$remote_user</span> [<span class="hljs-variable">$time_local</span>] &quot;<span class="hljs-variable">$request</span>&quot; &#x27;</span><br>                      <span class="hljs-string">&#x27;<span class="hljs-variable">$status</span> <span class="hljs-variable">$body_bytes_sent</span> &quot;<span class="hljs-variable">$http_referer</span>&quot; &#x27;</span><br>                      <span class="hljs-string">&#x27;&quot;<span class="hljs-variable">$http_user_agent</span>&quot; &quot;<span class="hljs-variable">$http_x_forwarded_for</span>&quot;&#x27;</span>;<br><br>    <span class="hljs-attribute">access_log</span>  /var/log/nginx/access.log  main;<br><br>    <span class="hljs-attribute">sendfile</span>        <span class="hljs-literal">on</span>;<br>    <span class="hljs-comment">#tcp_nopush     on;</span><br><br>    <span class="hljs-comment"># time for timeout</span><br>    <span class="hljs-attribute">keepalive_timeout</span>  <span class="hljs-number">65</span>;<br><br>    <span class="hljs-attribute">gzip</span>  <span class="hljs-literal">on</span>;<br>    <span class="hljs-attribute">gzip_types</span> text/plain application/javascript text/css;<br><br>    <span class="hljs-comment"># virtual machine</span><br>    <span class="hljs-section">server</span> &#123;<br>        <span class="hljs-comment"># port</span><br>        <span class="hljs-attribute">listen</span>   <span class="hljs-number">80</span>;<br>        <span class="hljs-comment"># hostname</span><br>        <span class="hljs-attribute">server_name</span>  localhost;<br>        <br>        <span class="hljs-comment"># listening path</span><br>        <span class="hljs-section">location</span> / &#123;<br>            <span class="hljs-attribute">root</span>   /usr/share/nginx/html;<br>            <span class="hljs-attribute">index</span>  index.html index.htm;<br>        &#125;<br><br>        <span class="hljs-comment">#error_page  404              /404.html;</span><br><br>        <span class="hljs-comment"># redirect server error pages to the static page /50x.html</span><br>        <span class="hljs-comment">#</span><br>        <span class="hljs-attribute">error_page</span>   <span class="hljs-number">500</span> <span class="hljs-number">502</span> <span class="hljs-number">503</span> <span class="hljs-number">504</span>  /50x.html;<br>        <span class="hljs-section">location</span> = /50x.html &#123;<br>            <span class="hljs-attribute">root</span>   /usr/share/nginx/html;<br>        &#125;<br><br>    &#125;<br><br>    <span class="hljs-attribute">include</span> /etc/nginx/conf.d/<span class="hljs-regexp">*.conf</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Make sure to put two files on the same level of package.json</p>
<img src="images/18.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 10.31.28 PM" style="zoom:50%;" />

<p>However, before we really deploy our website, we need to push it into github. The purpose of the step is Jenkins can get the file from github, but not locally. Remember the link of our repo: <code>https://github.com/xuq2/cs312final/</code></p>
<p>Now we can start to create our project in Jenkins. Back to the jenkins page, Click <code>New item</code>-&gt; Enter a proper name-&gt;Choose Freestyle project</p>
<p><img src="/images/post1/16.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 10.21.15 PM"></p>
<p>This is what it looks like:</p>
<p><img src="/images/post1/17.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 10.21.39 PM"></p>
<p>For this project, we can use command <code>Build now</code> to deploy things, and we need to configure them first.</p>
<p>Click <code>Configure</code> icon.</p>
<p>Input the name and select the <code>GitHub project</code> button, then Enter the github url into it.</p>
<p><img src="/images/post1/27.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 10.32.59 PM"></p>
<p>And in the source code management, select <code>Git</code> and input the url as well. The two steps are make sure our project is obtaining files from github.</p>
<p><img src="/images/post1/26.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 10.34.32 PM"></p>
<p>Scroll down, select <code>Provide Node &amp; npm bin/ folder to PATH</code> to use nodejs for our project.</p>
<p><img src="/images/post1/25.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 10.36.36 PM"></p>
<p>In Build section,  we are having some commands to build the project before we are running it into a docker container.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">echo $PATH<br>node -v<br>npm -v<br>npm install #install all dependencies that mentioned in package.json<br>npm run build #build the project which will output a dist/ file contains relavent files<br></code></pre></td></tr></table></figure>

<p><img src="/images/post1/19.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 10.40.39 PM"></p>
<p><img src="/images/post1/20.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 10.37.47 PM"></p>
<p>Then, we need to using ssh to connect to our server to deploy the website through docker. Input name and execute command are the final steps.</p>
<p><img src="/images/post1/21.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 10.43.00 PM"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">security unlock-keychain -p [password] \<br> &amp;&amp; cd  /Users/xuqi/Desktop/CS_312/final_project/cs312final  \<br> &amp;&amp; /usr/local/bin/docker build -f Dockerfile  -t cs312final . \<br> &amp;&amp; /usr/local/bin/docker run -d -p 8085:80 --name cs312final -v  /Users/xuqi/Desktop/CS_312/final_project/workspace/cs312final/dist:/usr/share/nginx/html -v  /Users/xuqi/Desktop/CS_312/final_project/workspace/cs312final/nginx.conf:/etc/nginx/nginx.conf cs312final<br></code></pre></td></tr></table></figure>

<p>There are four commands in the box.</p>
<ol>
<li><p><code>security unlock-keychain -p [password]</code> Because I am using mac, I have to unlock the keychain before I make some operations. The output will show  us  “User interaction is not allowed” if we ignore this step.</p>
</li>
<li><p><code>cd  /Users/xuqi/Desktop/CS_312/final_project/cs312final</code> is to open the directory of the project, because we are going to access our docker file to build and run.</p>
</li>
<li><p><code>/usr/local/bin/docker build -f Dockerfile  -t cs312final . </code> Build the image, name it to cs312final.</p>
</li>
<li><p><code>/usr/local/bin/docker run -d -p 8085:80 --name cs312final cs312final</code> </p>
<p>This command will run the container in background and the port is mapped to 8050 to the local machine. </p>
</li>
</ol>
<p>Back to the project page and click <code>Build now</code>, you will see all the operations will be completed automatically.</p>
<p><img src="/images/post1/22.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 9.39.47 PM"></p>
<p><img src="/images/post1/23.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 9.40.03 PM"></p>
<p><strong>Success!</strong></p>
<p>Then open your browser and input <code>localhost:8050</code>, you will see:</p>
<p><img src="/images/post1/24.png" srcset="/img/loading.gif" lazyload alt="Screen Shot 2021-06-06 at 10.11.38 PM"></p>
<p><strong>Done</strong></p>
<p>Jenkins can do more than this, there is pipeline project, there is trigger that you can set a condition to make it deploy automatically, for example, when we push our project to github, it will build and deploy…</p>
<p>Thank you for reading. ☕️</p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/Docker/">Docker</a>
                    
                  </div>
                
                
              </div>
              
                <p class="note note-warning">
                  
                    The blog is using <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 protocal</a>, please indicate the source if reproduced!
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/02/11/AsyncJs/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">AsyncJs</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->

  <div class="col-lg-7 mx-auto nopadding-x-md">
    <div class="container custom post-custom mx-auto">
      <img src="https://github.com/xuq2/xuq2.github.io/blob/master/img/avatar.png?raw=true" srcset="/img/loading.gif" lazyload alt="img" class="rounded mx-auto d-block mt-5" style="width:150px; height:150px;">
    </div>
  </div>


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <p class="iconfont icon-copyright"> 2021 <a herf="/"><span>Qi's World</span></a></p> <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>





  

  
    <!-- MathJax -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        loader: {
          load: ['ui/lazy']
        },
        options: {
          renderActions: {
            findScript: [10, doc => {
              document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                const display = !!node.type.match(/; *mode=display/);
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                const text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = { node: text, delim: '', n: 0 };
                math.end = { node: text, delim: '', n: 0 };
                doc.math.push(math);
              });
            }, '', false],
            insertedScript: [200, () => {
              document.querySelectorAll('mjx-container').forEach(node => {
                let target = node.parentNode;
                if (target.nodeName.toLowerCase() === 'li') {
                  target.parentNode.classList.add('has-jax');
                }
              });
            }, '', false]
          }
        }
      };
    </script>

    <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" ></script>

  





  <script  src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js" ></script>
  <script>
    if (window.mermaid) {
      mermaid.initialize({"theme":"default"});
    }
  </script>




  

  

  

  

  

  




  
<script src="/js/project.js"></script>



<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
